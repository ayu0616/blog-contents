---
published: true
publishedAt: 2024-06-27
tags:
  - 数学
created: 2024-06-26 17:15:54+09:00
modified: 2024-06-27 09:52:44+09:00
---

# モンティ・ホール問題で学ぶ条件付き確率

## はじめに

学者さえも欺いた**モンティ・ホール問題**という難問を用いて**条件付き確率**について学びたいという記事です。

実際のところはモンティ・ホール問題に関心がある人間はすでに条件付き確率をマスターしていると思うのですが、、、

学校や塾で勉強したことを実生活に応用することで理解がより深まるという効果もあると思うのでお許しください。モンティ・ホール問題が実生活といえるのかはここで議論しないものとします。

## モンティ・ホール問題とは

歴史的背景などについてはWikipediaなどをご参照ください。

[モンティ・ホール問題](https://ja.wikipedia.org/wiki/モンティ・ホール問題)

ここでは数学の問題として捉えたときに、モンティ・ホール問題とはどのようなものなのかを整理します。

プレイヤーが以下のようなゲームを行います。

【ゲームの流れ】

1. 3つの扉がある
    - うち2つは開けるとヤギがいる（はずれ）
    - 1つは開けると車がある（あたり）
2. プレイヤーは3つの扉のうち1つを選択する
3. 司会者は選ばれなかった扉のうち、はずれの扉を開ける
    - 選ばれなかったはずれの扉は1つまたは2つある
4. プレイヤーは現在選んでいる扉を変更せずにそのまま選び続けるか、もう一方の扉に変更するかを選択できる
5. プレイヤーが選択している扉があたりなら車がもらえるが、そうでなければ何ももらえない

込み入っているので整理します。プレイヤーは次に説明する2回の選択を行います。以下、**選択1**、**選択2**と呼びます。

1. 3つの扉から1つ選ぶ
2. 扉を変更するかどうかを選択する

このうち、2番目について「扉を変更するべきなのかどうか」というのがモンティ・ホール問題です。

## 解いてみよう

込み入った確率の問題は**場合分け**をすることによってうまくいくという言い伝えがあります。その言い伝えにしたがって場合分けをやってみましょう。

さきほどのプレイヤーが行う2つの選択のうち、片方を固定してみましょう。1番目を固定してそのそれぞれについて変更した／しなかったときにどうなるかを考えてみましょう。

場合分けの仕方は、3つの扉から偶然「あたりを選択したとき」と「はずれを選択したとき」です。

### あたりを選択したとき

プレイヤーは現在あたりを選択していることがわかっています。

司会者は残り2つの扉のうち、はずれの扉を開けますが、両方ともはずれなのでどちらを開こうが変わりありません。

司会者がはずれの扉を開けると、残りの扉は以下のようになります。

- あたりの扉（←選択している）
- はずれの扉

したがって、選択を変更しないならあたりの確率は1、変更するならあたりの確率は0となります。

### はずれを選択したとき

プレイヤーは現在はずれを選択していることがわかっています。

司会者は残り2つの扉のうち、はずれのほうの扉を開きます。

司会者がはずれの扉を開けると、残りの扉は以下のようになります。

- あたりの扉
- はずれの扉（←選択している）

したがって、選択を変更するならあたりの確率は1、変更しないならあたりの確率は0となります。

### 場合分けを結合する

以上の場合分けから、選択1.で自分があたりを選んだのかはずれを選んだのかがわかれば、選択2.を適切に行う（1.であたり→変更しない、はずれ→変更する）ことで確実にあたりを選ぶことができます。

選択1.であたりの扉を選択する確率は$\frac 1 3$、はずれの扉を選択する確率は$\frac 2 3$です。選択がわからない（＝確率的な）場合、最終的にあたりを選ぶ確率は以下の表になります。

|  | 選択1.であたり（$\frac 1 3$） | 選択1.ではずれ（$\frac 2 3$） | 合計 |
| --- | --- | --- | --- |
| 選択2.で変更する | $0$ | $\frac 2 3$ | $\frac 2 3$ |
| 選択2.で変更しない | $\frac 1 3$ | $0$ | $\frac 1 3$ |

よって1.で選択した扉があたりかどうかわからない場合、選択2.で変更するを選択すると$\frac 2 3$の確率で、変更しないを選択すると$\frac 1 3$であたりになります。よって変更したほうがあたる確率が高くなります。

## 条件付き確率を使おう

【下準備】

- 扉：$a,b,c$の3つ
- それぞれの扉があたりである事象：$A,B,C$
- 3つの扉は対照性を満たすので、以下のように固定する
    - プレイヤーは最初扉$a$を選択する
    - 司会者が扉$c$を開く事象：$Z$
    - これらの扉を入れ替えても、これと同様の結果が出る

最終的に知りたい確率は、$P_Z(A),P_Z(B)$です。司会者が扉$c$を開いたという世界のもとで、あたりである確率は$a,b$どちらの扉のほうが高いのか、を知りたいということです。

まず、明らかに$P(A)=P(B)=P(C)=\frac 1 3$です。

条件付き確率の公式は以下のとおりです。

$$
P_z(A)=\frac{P(A\cap Z)}{P(Z)} \tag 1
$$

また、$P_A(Z)$についても同様です

$$
P_A(Z)=\frac{P(A\cap Z)}{P(A)}\\
P(A\cap Z)=P_A(Z)P(A)
$$

$A$を$B$に置き換えても同様のことが成り立ちます。

$P_Z(A)$を求めるためには、$P(A),P_A(Z),P(Z)$を求めれば良いことがわかりましたが、$P(A)$はすでにわかっているので、のこりは2つです。

まずは$P_A(Z)$を求めましょう。これは扉$a$があたりだったという世界のもとで、司会者が扉$c$を開ける確率です。扉$a$があたりということは、扉$b,c$ははずれということになります。したがって司会者はこの2つの扉からランダムに1つ開けることになり、よって$P_A(Z)=\frac 1 2$ということになります。

次に$P_B(Z)$を求めます。これは扉$b$があたりだったという世界のもとで、司会者が扉$c$を開ける確率です。プレイヤーが扉$a$を選択していてかつ扉$b$があたりということは、司会者が開けられる扉は$c$しかありません。よって$P_B(Z)=1$です。

続いて$P(Z)$を求めます。

$P_A(Z)$は扉$a$があたりだという世界のもとでの司会者が扉$c$を開ける確率ですが、扉$a$があたりだという世界になる確率は、$P(A)=\frac 1 3$なので、$P(A\cap Z)= P_A(Z)P(Z)=\frac 1 6$となります。

同じように考えて、$P(B\cap Z)=\frac 1 3$になります。

扉$c$があたりになることと、司会者が扉$c$を開けることは両立し得ないので、$P(C\cap Z)=0$です。

$(A\cap Z)\cup(B\cap Z)\cup(C\cap Z)=Z$なので、$P(Z)=P(A\cap Z)+P(B\cap Z)+(C\cap Z)=\frac 1 2$となります。

(1)式に代入して、$P_Z(A)=\frac 1 3,P_Z(B)=\frac 2 3$で、$P_Z(A)<P_Z(B)$となります。これは扉$a$を選択して司会者が扉$c$を開けたとき、扉$b$があたりである確率が高いということを示していて、扉を変更したほうがあたりやすいことが示されました。

また、$a,b,c$を入れ替えても成り立つので、プレイヤーはいかなる場合も扉を変更したほうがあたりの確率が高いといえます。

## さいごに

私も高校生の時は条件付き確率に苦しめられたことがあります。
しかし、次のような考え方をすればわりとできるようになったので、ここで共有したいと思います。

💡 **$P_B(A)$：$B$が起こった世界での$A$が起こる確率**

それではみなさん、よい条件付き確率ライフを！
